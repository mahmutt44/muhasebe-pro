{% extends "base.html" %}

{% block title %}{{ t.dashboard }} - {{ t.app_name }}{% endblock %}

{% block content %}
<!-- Hoşgeldin Başlık -->
<div class="d-flex justify-content-between align-items-center mb-4">
    <div>
        <h2 class="fw-bold mb-1">
            <span style="background: var(--primary-gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
                {{ t.welcome }}
            </span>
        </h2>
        <p class="text-secondary mb-0">{{ t.dashboard }}</p>
    </div>
    <div class="d-flex align-items-center gap-2">
        <span class="badge bg-dark border border-secondary px-3 py-2">
            <i class="bi bi-calendar3 me-1"></i>
            {{ today_date.strftime('%d %B %Y') }}
        </span>
    </div>
</div>

<!-- İstatistik Kartları -->
<div class="row g-4 mb-4">
    <div class="col-xl-3 col-md-6">
        <div class="card h-100" style="border-left: 4px solid #667eea;">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-start">
                    <div>
                        <p class="text-secondary text-uppercase small fw-semibold mb-2">{{ t.net_balance }}</p>
                        <h3 class="fw-bold mb-0" style="color: #667eea;">₺{{ "%.2f"|format(cash_balance) }}</h3>
                    </div>
                    <div class="rounded-circle d-flex align-items-center justify-content-center" style="width: 48px; height: 48px; background: linear-gradient(135deg, rgba(102,126,234,0.2) 0%, rgba(118,75,162,0.2) 100%);">
                        <i class="bi bi-wallet2 fs-4" style="color: #667eea;"></i>
                    </div>
                </div>
                <div class="mt-3">
                    <small class="text-secondary">
                        <i class="bi bi-graph-up me-1"></i>{{ t.current_balance }}
                    </small>
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-xl-3 col-md-6">
        <div class="card h-100" style="border-left: 4px solid #38ef7d;">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-start">
                    <div>
                        <p class="text-secondary text-uppercase small fw-semibold mb-2">{{ t.total_income }}</p>
                        <h3 class="fw-bold mb-0 text-success">₺{{ "%.2f"|format(total_income) }}</h3>
                    </div>
                    <div class="rounded-circle d-flex align-items-center justify-content-center" style="width: 48px; height: 48px; background: linear-gradient(135deg, rgba(17,153,142,0.2) 0%, rgba(56,239,125,0.2) 100%);">
                        <i class="bi bi-graph-up-arrow fs-4 text-success"></i>
                    </div>
                </div>
                <div class="mt-3">
                    <small class="text-secondary">
                        <i class="bi bi-check-circle me-1"></i>{{ t.all_time }}
                    </small>
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-xl-3 col-md-6">
        <div class="card h-100" style="border-left: 4px solid #f45c43;">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-start">
                    <div>
                        <p class="text-secondary text-uppercase small fw-semibold mb-2">{{ t.total_expense }}</p>
                        <h3 class="fw-bold mb-0 text-danger">₺{{ "%.2f"|format(total_expense) }}</h3>
                    </div>
                    <div class="rounded-circle d-flex align-items-center justify-content-center" style="width: 48px; height: 48px; background: linear-gradient(135deg, rgba(235,51,73,0.2) 0%, rgba(244,92,67,0.2) 100%);">
                        <i class="bi bi-graph-down-arrow fs-4 text-danger"></i>
                    </div>
                </div>
                <div class="mt-3">
                    <small class="text-secondary">
                        <i class="bi bi-arrow-down me-1"></i>{{ t.all_time }}
                    </small>
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-xl-3 col-md-6">
        <div class="card h-100" style="border-left: 4px solid #f5576c;">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-start">
                    <div>
                        <p class="text-secondary text-uppercase small fw-semibold mb-2">{{ t.balance }}</p>
                        <h3 class="fw-bold mb-0 text-warning">₺{{ "%.2f"|format(total_debt) }}</h3>
                    </div>
                    <div class="rounded-circle d-flex align-items-center justify-content-center" style="width: 48px; height: 48px; background: linear-gradient(135deg, rgba(240,147,251,0.2) 0%, rgba(245,87,108,0.2) 100%);">
                        <i class="bi bi-credit-card fs-4 text-warning"></i>
                    </div>
                </div>
                <div class="mt-3">
                    <small class="text-secondary">
                        <i class="bi bi-people me-1"></i>{{ t.total_receivable }}
                    </small>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row g-4">
    <!-- Bugünkü İşlemler -->
    <div class="col-xl-6">
        <div class="card h-100">
            <div class="card-header d-flex justify-content-between align-items-center">
                <div class="d-flex align-items-center">
                    <div class="rounded-circle d-flex align-items-center justify-content-center me-2" style="width: 32px; height: 32px; background: var(--info-gradient);">
                        <i class="bi bi-clock-history text-white"></i>
                    </div>
                    <h6 class="mb-0 fw-semibold">{{ t.transactions }}</h6>
                </div>
                <span class="badge" style="background: var(--info-gradient);">{{ today_transactions|length }}</span>
            </div>
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table mb-0">
                        <thead>
                            <tr>
                                <th>{{ t.description }}</th>
                                <th class="text-end">{{ t.amount }}</th>
                                <th class="text-center">{{ t.transaction_type }}</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for transaction in today_transactions[:5] %}
                            <tr>
                                <td>
                                    <div class="d-flex align-items-center">
                                        <div class="rounded-circle d-flex align-items-center justify-content-center me-2" style="width: 32px; height: 32px; background: {{ 'var(--success-gradient)' if transaction.type == 'income' else 'var(--danger-gradient)' }};">
                                            <i class="bi bi-{{ 'arrow-up' if transaction.type == 'income' else 'arrow-down' }} text-white small"></i>
                                        </div>
                                        <span>{{ transaction.description or 'İşlem' }}</span>
                                    </div>
                                </td>
                                <td class="text-end">
                                    <span class="fw-semibold text-{{ 'success' if transaction.type == 'income' else 'danger' }}">
                                        {{ '+' if transaction.type == 'income' else '-' }}₺{{ "%.2f"|format(transaction.amount) }}
                                    </span>
                                </td>
                                <td class="text-center">
                                    <span class="badge" style="background: {{ 'var(--success-gradient)' if transaction.type == 'income' else 'var(--danger-gradient)' }};">
                                        {{ t.income if transaction.type == 'income' else t.expense }}
                                    </span>
                                </td>
                            </tr>
                            {% else %}
                            <tr>
                                <td colspan="3" class="text-center py-5">
                                    <i class="bi bi-inbox fs-1 text-secondary d-block mb-2"></i>
                                    <span class="text-secondary">{{ t.no_data }}</span>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="card-footer bg-transparent border-0 p-3">
                <a href="{{ url_for('main.transactions') }}" class="btn btn-outline-light btn-sm w-100">
                    <i class="bi bi-arrow-right me-1"></i>{{ t.view }} {{ t.transactions }}
                </a>
            </div>
        </div>
    </div>

    <!-- Son Fişler -->
    <div class="col-xl-6">
        <div class="card h-100">
            <div class="card-header d-flex justify-content-between align-items-center">
                <div class="d-flex align-items-center">
                    <div class="rounded-circle d-flex align-items-center justify-content-center me-2" style="width: 32px; height: 32px; background: var(--success-gradient);">
                        <i class="bi bi-receipt text-white"></i>
                    </div>
                    <h6 class="mb-0 fw-semibold">{{ t.receipts }}</h6>
                </div>
                <span class="badge" style="background: var(--success-gradient);">{{ recent_receipts|length }}</span>
            </div>
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table mb-0">
                        <thead>
                            <tr>
                                <th>{{ t.receipt_no }}</th>
                                <th>{{ t.customers }}</th>
                                <th class="text-end">{{ t.amount }}</th>
                                <th class="text-center">{{ t.view }}</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for receipt in recent_receipts[:5] %}
                            <tr>
                                <td>
                                    <div class="d-flex align-items-center">
                                        <div class="rounded-circle d-flex align-items-center justify-content-center me-2" style="width: 32px; height: 32px; background: var(--primary-gradient);">
                                            <i class="bi bi-receipt-cutoff text-white small"></i>
                                        </div>
                                        <div>
                                            <span class="fw-semibold">{{ receipt.receipt_no }}</span>
                                            <br><small class="text-secondary">{{ receipt.date.strftime('%d.%m') }}</small>
                                        </div>
                                    </div>
                                </td>
                                <td>
                                    <span class="text-secondary">{{ receipt.customer.name }}</span>
                                </td>
                                <td class="text-end">
                                    <span class="fw-semibold" style="color: #667eea;">₺{{ "%.2f"|format(receipt.total_amount) }}</span>
                                </td>
                                <td class="text-center">
                                    <a href="{{ url_for('main.receipt_detail', receipt_id=receipt.id) }}" class="btn btn-sm btn-outline-light">
                                        <i class="bi bi-eye"></i>
                                    </a>
                                </td>
                            </tr>
                            {% else %}
                            <tr>
                                <td colspan="4" class="text-center py-5">
                                    <i class="bi bi-receipt fs-1 text-secondary d-block mb-2"></i>
                                    <span class="text-secondary">{{ t.no_data }}</span>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="card-footer bg-transparent border-0 p-3">
                <a href="{{ url_for('main.receipt') }}" class="btn btn-success btn-sm w-100">
                    <i class="bi bi-plus-circle me-1"></i>{{ t.new_receipt }}
                </a>
            </div>
        </div>
    </div>
</div>

<!-- Hızlı İşlemler -->
<div class="row mt-4">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <div class="d-flex align-items-center">
                    <div class="rounded-circle d-flex align-items-center justify-content-center me-2" style="width: 32px; height: 32px; background: var(--warning-gradient);">
                        <i class="bi bi-lightning-charge-fill text-white"></i>
                    </div>
                    <h6 class="mb-0 fw-semibold">{{ t.quick_actions }}</h6>
                </div>
            </div>
            <div class="card-body">
                <div class="row g-3">
                    <div class="col-lg-3 col-md-6">
                        <a href="{{ url_for('main.receipt') }}" class="btn btn-success w-100 py-3 d-flex flex-column align-items-center">
                            <i class="bi bi-receipt fs-3 mb-2"></i>
                            <span class="fw-semibold">{{ t.new_receipt }}</span>
                            <small class="opacity-75">{{ t.receipts }}</small>
                        </a>
                    </div>
                    <div class="col-lg-3 col-md-6">
                        <a href="{{ url_for('main.transactions') }}" class="btn btn-primary w-100 py-3 d-flex flex-column align-items-center">
                            <i class="bi bi-arrow-left-right fs-3 mb-2"></i>
                            <span class="fw-semibold">{{ t.transactions }}</span>
                            <small class="opacity-75">{{ t.new_transaction }}</small>
                        </a>
                    </div>
                    <div class="col-lg-3 col-md-6">
                        <a href="{{ url_for('main.customers') }}" class="btn btn-info w-100 py-3 d-flex flex-column align-items-center">
                            <i class="bi bi-people fs-3 mb-2"></i>
                            <span class="fw-semibold">{{ t.customers }}</span>
                            <small class="opacity-75">{{ t.new_customer }}</small>
                        </a>
                    </div>
                    <div class="col-lg-3 col-md-6">
                        <a href="{{ url_for('main.products') }}" class="btn btn-warning w-100 py-3 d-flex flex-column align-items-center">
                            <i class="bi bi-box-seam fs-3 mb-2"></i>
                            <span class="fw-semibold">{{ t.products }}</span>
                            <small class="opacity-75">{{ t.new_product }}</small>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
